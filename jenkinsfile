pipeline {
    agent any
    tools {
        maven "maven-jenkins"
    }
    
    stages{
      stage("SCM"){
          steps {
             git(branch: 'main', credentialsId: '44feaac4-248a-4a31-bdfc-dc372382fbb1', url: 'https://github.com/nehalBaigSystemLtd/spring-petclinic')
             sh 'ls -lrt'
          }
      }
      stage("build"){
          steps {
            sh 'mvn clean compile'
          }
      }
      stage("test"){
          steps {
            sh 'mvn test'
          }
      }
      stage("deploy"){
          steps {
                sshagent(['7d94bfc0-245f-4637-a3da-dbae19921747']) {
                    //sh 'ssh -o StrictHostKeyChecking=no -l mrzjordan 182.176.114.79 "pwd;npm -v; cd ~/SystemLtd-Form;ls -lat;rm -rf node_modules;ls -lat;git pull origin qa;ls -lat;npm install --only=production;ls -lat;docker-compose restart node"'
                }  
           }
      }    
   }
}

